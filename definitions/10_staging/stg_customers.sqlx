config {
  type: "view",
  schema: "analytics_dev",
  name: "stg_customers",
  tags: ["staging", "prod"]
}

select distinct
  cast(name as string) as customer_id,
  cast(name as string) as customer_name,
  min(cast(event_ts as timestamp)) over(partition by cast(name as string)) as created_ts,
  current_timestamp() as load_ts
from ${ref("orders")}
where name is not null